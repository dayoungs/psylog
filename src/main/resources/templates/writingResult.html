<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/writingResult.css">
  <title>ì‘ì„±í•œ ê¸€ ë° ë¶„ì„ í™”ë©´</title>

  <!--í°íŠ¸ ì ìš©-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR&family=Prompt:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

   <!--ì•„ì´ì½˜ ì ìš©-->
  <script src="https://kit.fontawesome.com/a1969e7b61.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
</head>

<body>
<!-- í—¤ë” ë¶€ë¶„ -->
<div class="title">
  <h1><a href="/login_home" style="text-decoration-line: none; color: #FF6D3F">PSYLOG</a></h1>
  <button class="btn1" id="home_btn" onclick="location.href='/login_home'">í™ˆ</button>
  <button class="btn1" id="diary_btn" onclick="location.href='/post/list'">ì¼ê¸°ì¥</button>
  <button class="btn1" id="myPage_btn" onclick="location.href='/member/mypage'">ë§ˆì´ í˜ì´ì§€</button>
  <button class="btn2" id="logOut_btn"  onclick="location.href='/logout'" style="margin-right: 40px;">ë¡œê·¸ì•„ì›ƒ</button>
</div>


<!-- ì¼ê¸° ì‘ì„±ëœ ì¹¸ -->
<div class="diary-form">

  <div class="data" id="date" name="date" th:text="${post.updateDate}" style="color: #818181" readonly></div>
  <hr>

  <div class="data" th:text="${post.postTitle}" id="diary_title" name="diary_title" style="font-size: 25px;" readonly></div>
  <hr>

  <div id="emotion_container">
    <div id="emotion_selection">
      <select id="emotion" name="emotion" required onchange="displayImage()" disabled style="font-size: 20px; color:black;">
        <option value="">== ì˜¤ëŠ˜ì˜ ê¸°ë¶„ì„ ì„ íƒí•˜ì„¸ìš” ==</option>
        <option value="happy">ì‹ ë‚˜ê³  ê¸°ë»ìš”ğŸ˜„</option>
        <option value="excited">ë‘ê·¼ê±°ë¦¬ê³  ì„¤ë ˆìš”ğŸ˜</option>
        <option value="sad">ìŠ¬í”„ê³  ìš°ìš¸í•´ìš”ğŸ˜­</option>
        <option value="disappointed">ì¢Œì ˆ... ë˜ëŠ”ê²Œ ì—†ì–´ìš”ğŸ˜</option>
        <option value="angry">ì§œì¦ë‚˜ê³  í™”ê°€ë‚˜ìš”ğŸ˜¡</option>
        <option value="afraid">ë¶ˆì•ˆí•˜ê³  ë‘ë ¤ì›Œìš”ğŸ˜±</option>
        <option value="normal">ê¸°ì˜ì§€ë„ ìŠ¬í”„ì§€ë„ ì•Šì•„ìš”ğŸ˜‘</option>
      </select><br>
    </div>
    <img id="emotionImage" src="/images/íˆ¬ëª…ë°°ê²½.png">
  </div>
  <hr>


  <!--  <div class="data" id="content" th:text="${post.postContent}" name="content" readonly></div>-->
  <textarea id="content" th:text="${post.postContent}" name="content" readonly></textarea>

  <hr>
  <div style="height:100px;">
    <button onclick="" class="change_btn" id="delete_btn" style="width:100px;"><b>ì‚­ì œí•˜ê¸°</b></button>
    <button onclick="updateReq()" class="change_btn" id="fix_btn" style="width:100px; margin-right:15px;"><b>ìˆ˜ì •í•˜ê¸°</b></button>
  </div>
</div>

<!-- ë¶„ì„ ê²°ê³¼ -->
<div class="resultBox">
  <div class="result_title">
    <b><span>ë‚´ ì¹œêµ¬ </span>
      <span style="color:#FF6D3F" th:text="${member.friendNickname}"></span>
      ì˜ í•œ ë§ˆë”” </b><i class="fa-solid fa-pen-to-square"></i>
  </div>

   
  <div id="bigBox">
    <!-- ê°ì • ë¶„ì„ ê·¸ë˜í”„ -->
    <div id="graph">
      <canvas id="pie-chart" width="20000" height="1450"></canvas>
    </div>
    <!-- ê³µê°,ì¡°ì–¸ -->
    <div id="solution" th:text="${post.aiAnswer}"></div>
  </div> 

</div>

<script th:incline="javascript">
  const updateReq = () => {
    console.log("ìˆ˜ì • ìš”ì²­");
    const id = [[${post.postNo}]];
    location.href = "/post/update/" + id;
  }

  const negative = [[${post.negative}]];
  const positive = [[${post.positive}]];
  const neutral = [[${post.neutral}]];

  new Chart(document.getElementById("pie-chart"), {
    type: 'pie',
    data: {
      labels: ["ë¶€ì •", "ê¸ì •", "ì¤‘ë¦½"],
      datasets: [{
        label: "Sentiment (percent)",
        backgroundColor: ["#a7a8a8", "#FF6D3F", "#ffc5b6"],
        data: [negative, positive, neutral]
      }]
    },
    options: {
      title: {
        display: true,
        text: 'ë‚˜ì˜ ì¼ê¸°ì— ë‹´ê¸´ ê°ì •ì€??'
      }
    }
  });

  //ì„ íƒí•œ ê°ì • ìºë¦­í„°ë¥¼ ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜
  function displayImage() {
    var selectBox = document.getElementById("emotion");
    var selectedValue = selectBox.value;
    var imageElement = document.getElementById("emotionImage");
    if (selectedValue === "happy") {
      imageElement.src = "/images/ê¸°ì¨ì´.png";
    } else if (selectedValue === "excited") {
      imageElement.src = "/images/ì„¤ë ˜ì´.png";
    } else if (selectedValue === "sad") {
      imageElement.src = "/images/ìŠ¬í””ì´.png";
    } else if (selectedValue === "disappointed") {
      imageElement.src = "/images/ì¢Œì ˆì´.png";
    } else if (selectedValue === "angry") {
      imageElement.src = "/images/í™”ë‚¨ì´.png";
    } else if (selectedValue === "afraid") {
      imageElement.src = "/images/ë¶ˆì•ˆì´.png";
    } else if (selectedValue === "normal") {
      imageElement.src = "/images/ë³´í†µì´.png";
    } else {
      // íˆ¬ëª… ì´ë¯¸ì§€(ê°ì • ì„ íƒì„ í•˜ì§€ ì•Šì€ ê²½ìš°)
      imageElement.src = "images/íˆ¬ëª…ë°°ê²½.png";
    }
  }

</script>

</body>
</html>